<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ứng Dụng Học Tiếng Anh</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            height: 100vh;
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        .question {
            font-size: 20px;
            margin: 10px 0;
        }
        .result {
            font-size: 18px;
            margin: 20px 0;
        }
        .result.failed {
            color: red;
        }
        .result.passed {
            color: green;
        }
        button {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <h1>Ứng Dụng Học Tiếng Anh</h1>
    <!-- Câu hỏi -->
    <div id="vietnameseQuestion" class="question">Tiếng Việt sẽ hiện ở đây.</div>
    <div id="englishQuestion" class="question">Tiếng Anh sẽ hiện ở đây.</div>
    <!-- Nhập câu trả lời -->
    <input type="text" id="answer" placeholder="Điền từ bị thiếu" />
    <button onclick="checkAnswer()">Submit</button>
    <!-- Kết quả -->
    <div id="result" class="result"></div>
    <!-- Nút tiếp tục -->
    <div id="nextInstruction" style="color: blue; cursor: pointer; display: none;" onclick="getRandomQuestion()">Nhấn để tiếp tục</div>
    <!-- Nút phát âm -->
    <button id="speakButton" style="margin-top: 20px; display: none;" onclick="speakCurrentQuestion()">Phát âm</button>

    <script>
        let data = [];
        let currentQuestion = {};
        let isProcessing = false;

        // Tải dữ liệu khi ứng dụng khởi động
        window.onload = function () {
            // Dữ liệu nhúng trực tiếp
            const fileContent = `
                Be careful driving / Lái xe cẩn thận
                Can you translate this for me? / Bạn có thể dịch cho tôi cái này được không?
                Chicago is very different from Boston / Chicago rất khác Boston
                Don't worry / Đừng lo
                Excellent! / Xuất sắc!
            `;

            // Xử lý dữ liệu
            data = fileContent.split('\n')
                .map(line => line.trim())
                .filter(line => line.includes(' /'))
                .map(line => line.split(' /'));

            if (data.length === 0) {
                alert("Không có dữ liệu hợp lệ!");
                return;
            }

            getRandomQuestion(); // Hiển thị câu hỏi đầu tiên
        };

        function getRandomQuestion() {
            if (data.length === 0) {
                alert("Không còn câu hỏi nào!");
                return;
            }

            const randomIndex = Math.floor(Math.random() * data.length);
            const [english, vietnamese] = data[randomIndex];

            const words = english.split(" ");
            const blankIndex = Math.floor(Math.random() * words.length);
            const blankWord = words[blankIndex];
            words[blankIndex] = "___";

            currentQuestion = {
                english: words.join(" "),
                vietnamese: vietnamese.trim(),
                blankWord: blankWord.trim(),
                originalEnglish: english.trim(),
            };

            document.getElementById("vietnameseQuestion").innerText = "Tiếng Việt: " + vietnamese;
            document.getElementById("englishQuestion").innerText = "Tiếng Anh: " + currentQuestion.english;
            document.getElementById("result").innerText = "";
            document.getElementById("answer").value = "";
            document.getElementById("nextInstruction").style.display = "none";
            document.getElementById("speakButton").style.display = "inline-block";
            isProcessing = false;
        }

        function checkAnswer() {
            if (isProcessing) return;
            isProcessing = true;

            const userAnswer = document.getElementById("answer").value.trim().toLowerCase();
            const correctWord = currentQuestion.blankWord.toLowerCase();
            const result = document.getElementById("result");

            if (userAnswer === correctWord) {
                result.innerText = "Passed. Bạn giỏi quá!";
                result.className = "result passed";
            } else {
                result.innerText = `Failed. :( Từ đúng là: "${currentQuestion.blankWord}"`;
                result.className = "result failed";
            }

            document.getElementById("nextInstruction").style.display = "block";
        }

        function speakCurrentQuestion() {
            const utterance = new SpeechSynthesisUtterance(currentQuestion.originalEnglish);
            utterance.lang = "en-US";
            utterance.rate = 0.9;
            speechSynthesis.speak(utterance);
        }
    </script>
</body>
</html>
